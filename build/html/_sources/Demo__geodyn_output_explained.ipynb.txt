{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Demonstration\n",
    "\n",
    "**This notebook explains the data output from the GEODYN Starlette-SLR run.**\n",
    "\n",
    "First, load the data using the reading functions."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The base file name for this arc is: st030914_2wk.goco05s \n",
      "\n",
      "File exists: iieout \n",
      "        /data/runs_geodyn/st/results/goco05s_msis86/IIEOUT/st030914_2wk.goco05s\n",
      "File exists: ascii_xyz \n",
      "        /data/runs_geodyn/st/results/goco05s_msis86/XYZ_TRAJ/st030914_2wk.goco05s\n",
      "File exists: densityfil \n",
      "        /data/runs_geodyn/st/results/goco05s_msis86/DENSITY/st030914_2wk.goco05s\n",
      "\n",
      " Loading data... \n",
      "\n",
      "Parameter adjustment data loaded\n",
      "Trajectory data loaded\n",
      "Density data loaded\n",
      "Residual data loaded\n"
     ]
    }
   ],
   "source": [
    "%load_ext autoreload\n",
    "%autoreload 2\n",
    "\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "##################################\n",
    "# INPUT PARAMETERS:\n",
    "##################################\n",
    "sat_file = 'starlette'\n",
    "arc1 = '030914_2wk'\n",
    "grav_id ='goco05s' \n",
    "local_path = '/data/analysis/starlette_analysis/'\n",
    "SAT_ID = 7501001\n",
    "\n",
    "##################################\n",
    "# PATH TO DENSITY MODEL RUN of Choice:\n",
    "##################################\n",
    "msis86_model = 'msis86'\n",
    "path_to_msis86 = '/data/runs_geodyn/st/results/'+ grav_id+'_'+msis86_model+'/'\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "import sys  \n",
    "sys.path.insert(0, '/data/analysis/util_funcs/py_starlette/')\n",
    "from a_ReadStarlette import ReadStarlette\n",
    "\n",
    "AdjustedParams, Trajectory, Density, Resids = ReadStarlette(arc1, \n",
    "                                                           sat_file,\n",
    "                                                           grav_id, \n",
    "                                                           local_path, \n",
    "                                                           path_to_msis86)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Adjusted Parameters:\n",
    "\n",
    " - The Adjusted Parameters are read in from the `iieout` file (`Unit 6`).\n",
    " - These include the State Vector at the start of the ARC, drag coefficient (CD), the solar radiation coefficient (CR), and the adjusted empirical accelerations (GA).\n",
    "    - the CD is controlled/output by the DRAG card.  \n",
    "    - the GA is ouput by the ACCEL9 card (the 9 parameter general acceleration)\n",
    " - `AdjustedParams` is a dictionary in which the first dimension stores each geodyn run iteration:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "dict_keys([1, 2, 3, 4, 5])"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "AdjustedParams.keys()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "And the 2nd dimension stores all of the adjusted parameters:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "dict_keys(['0CD', '0GA', '0GA_t2', '0XPOS', '0YPOS', '0ZPOS', '0XVEL', '0YVEL', '0ZVEL'])"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "AdjustedParams[5].keys()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Each adjusted parameter then has the associated statistics:\n",
    "\n",
    "          APRIORI  VALUE\n",
    "          PREVIOUS VALUE              \n",
    "          CURRENT  VALUE              \n",
    "          TOTAL DELTA\n",
    "          CURRENT DELTA\n",
    "          APRIORI SIGMA\n",
    "          CURRENT SIGMA\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "-1228610.639773413"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "AdjustedParams[5]['0XPOS']['CURRENT_VALUE']"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In the case of CD and GA, there are multiple values for each, and an additional dictionary exists for each value"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "dict_keys(['0GA 9P 11', '0GA 9P 12', '0GA 9P 21', '0GA 9P 22']) \n",
      "\n",
      "dict_keys(['T01', 'T02', 'T03', 'T04', 'T05', 'T06', 'T07', 'T08', 'T09', 'T10', 'T11', 'T12', 'T13', 'T14', 'T15', 'T16', 'T17', 'T18', 'T19', 'T20', 'T21', 'T22', 'T23', 'T24', 'T25', 'T26', 'T27', 'T28', 'T29', 'T30', 'T31', 'T32', 'T33', 'T34', 'T35', 'T36', 'T37', 'T38', 'T39', 'T40', 'T41', 'T42'])\n"
     ]
    }
   ],
   "source": [
    "print(AdjustedParams[5]['0GA'].keys(),'\\n')\n",
    "\n",
    "print(AdjustedParams[5]['0CD'].keys())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'APRIORI_VALUE': 0.0,\n",
       " 'PREVIOUS_VALUE': 5.536419290656419e-11,\n",
       " 'CURRENT_VALUE': 5.546253541325767e-11,\n",
       " 'TOTAL_DELTA': -5.54625354133e-11,\n",
       " 'CURRENT_DELTA': -9.83425066935e-14,\n",
       " 'APRIORI_SIGMA': 1.0,\n",
       " 'CURRENT_SIGMA': 1.6930522e-11}"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "AdjustedParams[5]['0GA']['0GA 9P 11']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "dict_keys([1, 2, 3, 4, 5])"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "AdjustedParams.keys()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "And the 2nd dimension stores all of the adjusted parameters:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "dict_keys(['0CD', '0GA', '0GA_t2', '0XPOS', '0YPOS', '0ZPOS', '0XVEL', '0YVEL', '0ZVEL'])"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "AdjustedParams[5].keys()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Trajectory Data:\n",
    "\n",
    " - The trajectory data can come from multiple sources.  *The official output should come from the binary orbit file, but that is not working as of January 2020.*  Instead, we use the orbit file printout (ORBTVU card) to printout the trajectory data to an ascii file (`Unit 10` for keplerian and `Unit 08` for cartesian).  These are then placed in the `KEP_TRAJ` and `XYZ_TRAJ` data directories before the temporary files are purged.\n",
    " \n",
    " \n",
    "\n",
    "- The `Trajectory` structure is a dictionary in which the first dimension represents the different satellites, and the second dimension is a Pandas DataFrame containing the trajectory data from the `ORBTVU` card in which the first dimension stores each geodyn run iteration:\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Indexing the first dimension will show the satellites in the GEODYN run that were saved.  They are saved according to their SAT_ID.  Since the Starlette-SLR runs only contain the Starlette satellite, this is the only one saved."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "dict_keys([7501001])"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Trajectory.keys()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The trajectory data can then be indexed by SAT_ID to show the pandas dataframe containing the data. The stored variables can be found with the `.columns` method."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['YYMMDD', 'HHMM', 'SECONDS', 'X', 'Y', 'Z', 'XDOT', 'YDOT', 'ZDOT',\n",
      "       'LAT', 'LONG', 'HEIGHT', 'timeHHMM', 'year', 'month', 'day', 'hours',\n",
      "       'minutes', 'secs', 'Date'],\n",
      "      dtype='object')\n"
     ]
    }
   ],
   "source": [
    "print(Trajectory[7501001].columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>YYMMDD</th>\n",
       "      <th>HHMM</th>\n",
       "      <th>SECONDS</th>\n",
       "      <th>X</th>\n",
       "      <th>Y</th>\n",
       "      <th>Z</th>\n",
       "      <th>XDOT</th>\n",
       "      <th>YDOT</th>\n",
       "      <th>ZDOT</th>\n",
       "      <th>LAT</th>\n",
       "      <th>LONG</th>\n",
       "      <th>HEIGHT</th>\n",
       "      <th>timeHHMM</th>\n",
       "      <th>year</th>\n",
       "      <th>month</th>\n",
       "      <th>day</th>\n",
       "      <th>hours</th>\n",
       "      <th>minutes</th>\n",
       "      <th>secs</th>\n",
       "      <th>Date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>30914</td>\n",
       "      <td>105</td>\n",
       "      <td>55.205719</td>\n",
       "      <td>-3902733.45</td>\n",
       "      <td>5158963.35</td>\n",
       "      <td>-3130061.00</td>\n",
       "      <td>-5675.94599</td>\n",
       "      <td>-1433.45008</td>\n",
       "      <td>4725.70967</td>\n",
       "      <td>-25.954786</td>\n",
       "      <td>118.024110</td>\n",
       "      <td>812276.80</td>\n",
       "      <td>0105</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>14</td>\n",
       "      <td>01</td>\n",
       "      <td>05</td>\n",
       "      <td>55</td>\n",
       "      <td>2003-09-14 01:05:55</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>30914</td>\n",
       "      <td>106</td>\n",
       "      <td>15.005953</td>\n",
       "      <td>-4014288.94</td>\n",
       "      <td>5129496.49</td>\n",
       "      <td>-3035836.70</td>\n",
       "      <td>-5591.75463</td>\n",
       "      <td>-1542.86306</td>\n",
       "      <td>4791.45070</td>\n",
       "      <td>-25.120244</td>\n",
       "      <td>118.880387</td>\n",
       "      <td>811968.94</td>\n",
       "      <td>0106</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>14</td>\n",
       "      <td>01</td>\n",
       "      <td>06</td>\n",
       "      <td>15</td>\n",
       "      <td>2003-09-14 01:06:15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>30914</td>\n",
       "      <td>106</td>\n",
       "      <td>47.006428</td>\n",
       "      <td>-4190987.23</td>\n",
       "      <td>5077312.08</td>\n",
       "      <td>-2880862.22</td>\n",
       "      <td>-5450.70994</td>\n",
       "      <td>-1718.31837</td>\n",
       "      <td>4893.42231</td>\n",
       "      <td>-23.758977</td>\n",
       "      <td>120.237767</td>\n",
       "      <td>811607.96</td>\n",
       "      <td>0106</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>14</td>\n",
       "      <td>01</td>\n",
       "      <td>06</td>\n",
       "      <td>47</td>\n",
       "      <td>2003-09-14 01:06:47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>30914</td>\n",
       "      <td>107</td>\n",
       "      <td>13.806875</td>\n",
       "      <td>-4335433.07</td>\n",
       "      <td>5029307.46</td>\n",
       "      <td>-2748618.90</td>\n",
       "      <td>-5327.95616</td>\n",
       "      <td>-1863.82658</td>\n",
       "      <td>4974.68198</td>\n",
       "      <td>-22.607839</td>\n",
       "      <td>121.350810</td>\n",
       "      <td>811436.43</td>\n",
       "      <td>0107</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>14</td>\n",
       "      <td>01</td>\n",
       "      <td>07</td>\n",
       "      <td>13</td>\n",
       "      <td>2003-09-14 01:07:13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>30914</td>\n",
       "      <td>107</td>\n",
       "      <td>47.207484</td>\n",
       "      <td>-4510756.72</td>\n",
       "      <td>4964053.31</td>\n",
       "      <td>-2580843.47</td>\n",
       "      <td>-5169.22701</td>\n",
       "      <td>-2043.14535</td>\n",
       "      <td>5070.56125</td>\n",
       "      <td>-21.160247</td>\n",
       "      <td>122.709738</td>\n",
       "      <td>811390.75</td>\n",
       "      <td>0107</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>14</td>\n",
       "      <td>01</td>\n",
       "      <td>07</td>\n",
       "      <td>47</td>\n",
       "      <td>2003-09-14 01:07:47</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  YYMMDD HHMM    SECONDS            X           Y            Z         XDOT  \\\n",
       "2  30914  105  55.205719  -3902733.45  5158963.35  -3130061.00  -5675.94599   \n",
       "3  30914  106  15.005953  -4014288.94  5129496.49  -3035836.70  -5591.75463   \n",
       "4  30914  106  47.006428  -4190987.23  5077312.08  -2880862.22  -5450.70994   \n",
       "5  30914  107  13.806875  -4335433.07  5029307.46  -2748618.90  -5327.95616   \n",
       "6  30914  107  47.207484  -4510756.72  4964053.31  -2580843.47  -5169.22701   \n",
       "\n",
       "          YDOT        ZDOT         LAT        LONG     HEIGHT timeHHMM  year  \\\n",
       "2  -1433.45008  4725.70967  -25.954786  118.024110  812276.80     0105  2003   \n",
       "3  -1542.86306  4791.45070  -25.120244  118.880387  811968.94     0106  2003   \n",
       "4  -1718.31837  4893.42231  -23.758977  120.237767  811607.96     0106  2003   \n",
       "5  -1863.82658  4974.68198  -22.607839  121.350810  811436.43     0107  2003   \n",
       "6  -2043.14535  5070.56125  -21.160247  122.709738  811390.75     0107  2003   \n",
       "\n",
       "  month day hours minutes secs                Date  \n",
       "2    09  14    01      05   55 2003-09-14 01:05:55  \n",
       "3    09  14    01      06   15 2003-09-14 01:06:15  \n",
       "4    09  14    01      06   47 2003-09-14 01:06:47  \n",
       "5    09  14    01      07   13 2003-09-14 01:07:13  \n",
       "6    09  14    01      07   47 2003-09-14 01:07:47  "
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Trajectory[7501001].head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Density Data:\n",
    "\n",
    "- GEODYN does not actually have a built in method for printing out the density. As such, the density has been printd by modifying the `DRAG.f90` subroutine in the `IIE/MODS` directory.  The modification consists of printing the density and trajectory data at each timestep of the GEODYN run.\n",
    "- The density data is stored as an ascii file named `fort.99`, which is then stored to the  `DENSITY`directory before the temporary files are purged.\n",
    "- The density data saves the longitutde, latitude, altitude coordinates, and cartesian coordinates.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Elapsed Secs', 'YYMMDD', 'HHMMSS', 'Lat', 'Lon', 'Height (meters)',\n",
       "       'rho (kg/m**3)', 'delta_rho (kg/m**3/m)', 'X', 'Y', 'Z', 'XDOT', 'YDOT',\n",
       "       'ZDOT', 'timeHHMMSS', 'year', 'month', 'day', 'hours', 'minutes',\n",
       "       'secs', 'Date'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Density.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Elapsed Secs</th>\n",
       "      <th>YYMMDD</th>\n",
       "      <th>HHMMSS</th>\n",
       "      <th>Lat</th>\n",
       "      <th>Lon</th>\n",
       "      <th>Height (meters)</th>\n",
       "      <th>rho (kg/m**3)</th>\n",
       "      <th>delta_rho (kg/m**3/m)</th>\n",
       "      <th>X</th>\n",
       "      <th>Y</th>\n",
       "      <th>...</th>\n",
       "      <th>YDOT</th>\n",
       "      <th>ZDOT</th>\n",
       "      <th>timeHHMMSS</th>\n",
       "      <th>year</th>\n",
       "      <th>month</th>\n",
       "      <th>day</th>\n",
       "      <th>hours</th>\n",
       "      <th>minutes</th>\n",
       "      <th>secs</th>\n",
       "      <th>Date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>210.0</td>\n",
       "      <td>30914</td>\n",
       "      <td>434</td>\n",
       "      <td>45.6973</td>\n",
       "      <td>278.5740</td>\n",
       "      <td>1083058.594</td>\n",
       "      <td>1.623031e-15</td>\n",
       "      <td>0.0</td>\n",
       "      <td>182992.974</td>\n",
       "      <td>-5215697.130</td>\n",
       "      <td>...</td>\n",
       "      <td>-1841.620957</td>\n",
       "      <td>-1912.851416</td>\n",
       "      <td>000434</td>\n",
       "      <td>2003.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>2003-09-14 00:04:34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>225.0</td>\n",
       "      <td>30914</td>\n",
       "      <td>449</td>\n",
       "      <td>45.3666</td>\n",
       "      <td>279.6052</td>\n",
       "      <td>1084271.860</td>\n",
       "      <td>1.606673e-15</td>\n",
       "      <td>0.0</td>\n",
       "      <td>284238.712</td>\n",
       "      <td>-5242756.035</td>\n",
       "      <td>...</td>\n",
       "      <td>-1766.174236</td>\n",
       "      <td>-1989.534319</td>\n",
       "      <td>000449</td>\n",
       "      <td>2003.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>49.0</td>\n",
       "      <td>2003-09-14 00:04:49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>240.0</td>\n",
       "      <td>30914</td>\n",
       "      <td>504</td>\n",
       "      <td>45.0256</td>\n",
       "      <td>280.6232</td>\n",
       "      <td>1085455.504</td>\n",
       "      <td>1.590705e-15</td>\n",
       "      <td>0.0</td>\n",
       "      <td>385422.960</td>\n",
       "      <td>-5268680.634</td>\n",
       "      <td>...</td>\n",
       "      <td>-1690.382976</td>\n",
       "      <td>-2065.747643</td>\n",
       "      <td>000504</td>\n",
       "      <td>2003.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>2003-09-14 00:05:04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>255.0</td>\n",
       "      <td>30914</td>\n",
       "      <td>519</td>\n",
       "      <td>44.6746</td>\n",
       "      <td>281.6279</td>\n",
       "      <td>1086609.356</td>\n",
       "      <td>1.575121e-15</td>\n",
       "      <td>0.0</td>\n",
       "      <td>486523.867</td>\n",
       "      <td>-5293465.880</td>\n",
       "      <td>...</td>\n",
       "      <td>-1614.263040</td>\n",
       "      <td>-2141.476196</td>\n",
       "      <td>000519</td>\n",
       "      <td>2003.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>2003-09-14 00:05:19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>270.0</td>\n",
       "      <td>30914</td>\n",
       "      <td>534</td>\n",
       "      <td>44.3139</td>\n",
       "      <td>282.6193</td>\n",
       "      <td>1087733.252</td>\n",
       "      <td>1.559916e-15</td>\n",
       "      <td>0.0</td>\n",
       "      <td>587519.621</td>\n",
       "      <td>-5317106.961</td>\n",
       "      <td>...</td>\n",
       "      <td>-1537.830323</td>\n",
       "      <td>-2216.704901</td>\n",
       "      <td>000534</td>\n",
       "      <td>2003.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>2003-09-14 00:05:34</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Elapsed Secs  YYMMDD  HHMMSS      Lat       Lon  Height (meters)  \\\n",
       "0         210.0   30914     434  45.6973  278.5740      1083058.594   \n",
       "1         225.0   30914     449  45.3666  279.6052      1084271.860   \n",
       "2         240.0   30914     504  45.0256  280.6232      1085455.504   \n",
       "3         255.0   30914     519  44.6746  281.6279      1086609.356   \n",
       "4         270.0   30914     534  44.3139  282.6193      1087733.252   \n",
       "\n",
       "   rho (kg/m**3)  delta_rho (kg/m**3/m)           X            Y  ...  \\\n",
       "0   1.623031e-15                    0.0  182992.974 -5215697.130  ...   \n",
       "1   1.606673e-15                    0.0  284238.712 -5242756.035  ...   \n",
       "2   1.590705e-15                    0.0  385422.960 -5268680.634  ...   \n",
       "3   1.575121e-15                    0.0  486523.867 -5293465.880  ...   \n",
       "4   1.559916e-15                    0.0  587519.621 -5317106.961  ...   \n",
       "\n",
       "          YDOT         ZDOT  timeHHMMSS    year month   day  hours  minutes  \\\n",
       "0 -1841.620957 -1912.851416      000434  2003.0   9.0  14.0    0.0      4.0   \n",
       "1 -1766.174236 -1989.534319      000449  2003.0   9.0  14.0    0.0      4.0   \n",
       "2 -1690.382976 -2065.747643      000504  2003.0   9.0  14.0    0.0      5.0   \n",
       "3 -1614.263040 -2141.476196      000519  2003.0   9.0  14.0    0.0      5.0   \n",
       "4 -1537.830323 -2216.704901      000534  2003.0   9.0  14.0    0.0      5.0   \n",
       "\n",
       "   secs                Date  \n",
       "0  34.0 2003-09-14 00:04:34  \n",
       "1  49.0 2003-09-14 00:04:49  \n",
       "2   4.0 2003-09-14 00:05:04  \n",
       "3  19.0 2003-09-14 00:05:19  \n",
       "4  34.0 2003-09-14 00:05:34  \n",
       "\n",
       "[5 rows x 22 columns]"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Density.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Residual Data:\n",
    "- Similar to the trajectory data, *the official output of the residuals should come from the binary residual file (Unit 19), but that is not working as of January 2020*. Instead, we read in the residuals that are printed in ascii formats to the `iieout` file using the `OBSVU` card.\n",
    "- The residuals are saved as a Pandas DataFrame.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>YYMMDD</th>\n",
       "      <th>HHMM</th>\n",
       "      <th>Sec-UTC-R</th>\n",
       "      <th>Observation</th>\n",
       "      <th>Residual</th>\n",
       "      <th>Ratio to sigma</th>\n",
       "      <th>Elev1</th>\n",
       "      <th>Elev2</th>\n",
       "      <th>OBS No.</th>\n",
       "      <th>...</th>\n",
       "      <th>timeHHMM</th>\n",
       "      <th>year</th>\n",
       "      <th>month</th>\n",
       "      <th>day</th>\n",
       "      <th>hours</th>\n",
       "      <th>minutes</th>\n",
       "      <th>secs</th>\n",
       "      <th>microsecs</th>\n",
       "      <th>Date</th>\n",
       "      <th>Ratio_to_sigma_fixed</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>30914</td>\n",
       "      <td>105</td>\n",
       "      <td>55.208831</td>\n",
       "      <td>933.052599576</td>\n",
       "      <td>-0.001484</td>\n",
       "      <td>-0.0015</td>\n",
       "      <td>58.485935</td>\n",
       "      <td>58.485839</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0105</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>14</td>\n",
       "      <td>01</td>\n",
       "      <td>05</td>\n",
       "      <td>55</td>\n",
       "      <td>208831</td>\n",
       "      <td>2003-09-14 01:05:55.208831</td>\n",
       "      <td>-0.0015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>30914</td>\n",
       "      <td>106</td>\n",
       "      <td>15.009306</td>\n",
       "      <td>1005.251863666</td>\n",
       "      <td>-0.000437</td>\n",
       "      <td>-0.0004</td>\n",
       "      <td>51.260530</td>\n",
       "      <td>51.260437</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>0106</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>14</td>\n",
       "      <td>01</td>\n",
       "      <td>06</td>\n",
       "      <td>15</td>\n",
       "      <td>009306</td>\n",
       "      <td>2003-09-14 01:06:15.009306</td>\n",
       "      <td>-0.0004</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>30914</td>\n",
       "      <td>106</td>\n",
       "      <td>47.010250</td>\n",
       "      <td>1145.739853454</td>\n",
       "      <td>-0.002657</td>\n",
       "      <td>-0.0027</td>\n",
       "      <td>41.550447</td>\n",
       "      <td>41.550361</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>0106</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>14</td>\n",
       "      <td>01</td>\n",
       "      <td>06</td>\n",
       "      <td>47</td>\n",
       "      <td>010250</td>\n",
       "      <td>2003-09-14 01:06:47.010250</td>\n",
       "      <td>-0.0027</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>30914</td>\n",
       "      <td>107</td>\n",
       "      <td>13.811144</td>\n",
       "      <td>1279.798448021</td>\n",
       "      <td>-0.006932</td>\n",
       "      <td>-0.0069</td>\n",
       "      <td>35.007633</td>\n",
       "      <td>35.007553</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>0107</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>14</td>\n",
       "      <td>01</td>\n",
       "      <td>07</td>\n",
       "      <td>13</td>\n",
       "      <td>811144</td>\n",
       "      <td>2003-09-14 01:07:13.811144</td>\n",
       "      <td>-0.0069</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>30914</td>\n",
       "      <td>107</td>\n",
       "      <td>47.212357</td>\n",
       "      <td>1461.073729804</td>\n",
       "      <td>-0.011274</td>\n",
       "      <td>-0.0113</td>\n",
       "      <td>28.408244</td>\n",
       "      <td>28.408171</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>0107</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>14</td>\n",
       "      <td>01</td>\n",
       "      <td>07</td>\n",
       "      <td>47</td>\n",
       "      <td>212357</td>\n",
       "      <td>2003-09-14 01:07:47.212357</td>\n",
       "      <td>-0.0113</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3999</th>\n",
       "      <td>5688</td>\n",
       "      <td>30927</td>\n",
       "      <td>2306</td>\n",
       "      <td>16.259539</td>\n",
       "      <td>1260.651605954</td>\n",
       "      <td>0.006996</td>\n",
       "      <td>0.0070</td>\n",
       "      <td>53.959755</td>\n",
       "      <td>53.959671</td>\n",
       "      <td>4000</td>\n",
       "      <td>...</td>\n",
       "      <td>2306</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>27</td>\n",
       "      <td>23</td>\n",
       "      <td>06</td>\n",
       "      <td>16</td>\n",
       "      <td>259539</td>\n",
       "      <td>2003-09-27 23:06:16.259539</td>\n",
       "      <td>0.0070</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4000</th>\n",
       "      <td>5689</td>\n",
       "      <td>30927</td>\n",
       "      <td>2306</td>\n",
       "      <td>46.014220</td>\n",
       "      <td>1374.565632664</td>\n",
       "      <td>0.002611</td>\n",
       "      <td>0.0026</td>\n",
       "      <td>46.639968</td>\n",
       "      <td>46.639884</td>\n",
       "      <td>4001</td>\n",
       "      <td>...</td>\n",
       "      <td>2306</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>27</td>\n",
       "      <td>23</td>\n",
       "      <td>06</td>\n",
       "      <td>46</td>\n",
       "      <td>014220</td>\n",
       "      <td>2003-09-27 23:06:46.014220</td>\n",
       "      <td>0.0026</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4001</th>\n",
       "      <td>5690</td>\n",
       "      <td>30927</td>\n",
       "      <td>2307</td>\n",
       "      <td>14.118743</td>\n",
       "      <td>1496.430957455</td>\n",
       "      <td>-0.001994</td>\n",
       "      <td>-0.0020</td>\n",
       "      <td>40.669100</td>\n",
       "      <td>40.669018</td>\n",
       "      <td>4002</td>\n",
       "      <td>...</td>\n",
       "      <td>2307</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>27</td>\n",
       "      <td>23</td>\n",
       "      <td>07</td>\n",
       "      <td>14</td>\n",
       "      <td>118743</td>\n",
       "      <td>2003-09-27 23:07:14.118743</td>\n",
       "      <td>-0.0020</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4002</th>\n",
       "      <td>5691</td>\n",
       "      <td>30927</td>\n",
       "      <td>2307</td>\n",
       "      <td>46.624060</td>\n",
       "      <td>1650.422940823</td>\n",
       "      <td>-0.006786</td>\n",
       "      <td>-0.0068</td>\n",
       "      <td>34.755223</td>\n",
       "      <td>34.755145</td>\n",
       "      <td>4003</td>\n",
       "      <td>...</td>\n",
       "      <td>2307</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>27</td>\n",
       "      <td>23</td>\n",
       "      <td>07</td>\n",
       "      <td>46</td>\n",
       "      <td>624060</td>\n",
       "      <td>2003-09-27 23:07:46.624060</td>\n",
       "      <td>-0.0068</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4003</th>\n",
       "      <td>5692</td>\n",
       "      <td>30927</td>\n",
       "      <td>2308</td>\n",
       "      <td>5.727222</td>\n",
       "      <td>1745.985693706</td>\n",
       "      <td>-0.003580</td>\n",
       "      <td>-0.0036</td>\n",
       "      <td>31.700982</td>\n",
       "      <td>31.700906</td>\n",
       "      <td>4004</td>\n",
       "      <td>...</td>\n",
       "      <td>2308</td>\n",
       "      <td>2003</td>\n",
       "      <td>09</td>\n",
       "      <td>27</td>\n",
       "      <td>23</td>\n",
       "      <td>08</td>\n",
       "      <td>5.</td>\n",
       "      <td>27222</td>\n",
       "      <td>2003-09-27 23:08:05.027222</td>\n",
       "      <td>-0.0036</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4004 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      index YYMMDD  HHMM  Sec-UTC-R     Observation   Residual Ratio to sigma  \\\n",
       "0         0  30914   105  55.208831   933.052599576  -0.001484        -0.0015   \n",
       "1         1  30914   106  15.009306  1005.251863666  -0.000437        -0.0004   \n",
       "2         2  30914   106  47.010250  1145.739853454  -0.002657        -0.0027   \n",
       "3         3  30914   107  13.811144  1279.798448021  -0.006932        -0.0069   \n",
       "4         4  30914   107  47.212357  1461.073729804  -0.011274        -0.0113   \n",
       "...     ...    ...   ...        ...             ...        ...            ...   \n",
       "3999   5688  30927  2306  16.259539  1260.651605954   0.006996         0.0070   \n",
       "4000   5689  30927  2306  46.014220  1374.565632664   0.002611         0.0026   \n",
       "4001   5690  30927  2307  14.118743  1496.430957455  -0.001994        -0.0020   \n",
       "4002   5691  30927  2307  46.624060  1650.422940823  -0.006786        -0.0068   \n",
       "4003   5692  30927  2308   5.727222  1745.985693706  -0.003580        -0.0036   \n",
       "\n",
       "          Elev1      Elev2 OBS No.  ... timeHHMM  year month day hours  \\\n",
       "0     58.485935  58.485839       1  ...     0105  2003    09  14    01   \n",
       "1     51.260530  51.260437       2  ...     0106  2003    09  14    01   \n",
       "2     41.550447  41.550361       3  ...     0106  2003    09  14    01   \n",
       "3     35.007633  35.007553       4  ...     0107  2003    09  14    01   \n",
       "4     28.408244  28.408171       5  ...     0107  2003    09  14    01   \n",
       "...         ...        ...     ...  ...      ...   ...   ...  ..   ...   \n",
       "3999  53.959755  53.959671    4000  ...     2306  2003    09  27    23   \n",
       "4000  46.639968  46.639884    4001  ...     2306  2003    09  27    23   \n",
       "4001  40.669100  40.669018    4002  ...     2307  2003    09  27    23   \n",
       "4002  34.755223  34.755145    4003  ...     2307  2003    09  27    23   \n",
       "4003  31.700982  31.700906    4004  ...     2308  2003    09  27    23   \n",
       "\n",
       "     minutes secs microsecs                       Date Ratio_to_sigma_fixed  \n",
       "0         05   55    208831 2003-09-14 01:05:55.208831              -0.0015  \n",
       "1         06   15    009306 2003-09-14 01:06:15.009306              -0.0004  \n",
       "2         06   47    010250 2003-09-14 01:06:47.010250              -0.0027  \n",
       "3         07   13    811144 2003-09-14 01:07:13.811144              -0.0069  \n",
       "4         07   47    212357 2003-09-14 01:07:47.212357              -0.0113  \n",
       "...      ...  ...       ...                        ...                  ...  \n",
       "3999      06   16    259539 2003-09-27 23:06:16.259539               0.0070  \n",
       "4000      06   46    014220 2003-09-27 23:06:46.014220               0.0026  \n",
       "4001      07   14    118743 2003-09-27 23:07:14.118743              -0.0020  \n",
       "4002      07   46    624060 2003-09-27 23:07:46.624060              -0.0068  \n",
       "4003      08   5.     27222 2003-09-27 23:08:05.027222              -0.0036  \n",
       "\n",
       "[4004 rows x 21 columns]"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Resids"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
